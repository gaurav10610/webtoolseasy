(self.webpackChunkwebtoolseasy=self.webpackChunkwebtoolseasy||[]).push([[54],{4054:(C,v,h)=>{"use strict";h.r(v),h.d(v,{ScreenRecorderModule:()=>X});var l=h(6814),p=h(3403),o=h(5861),t=h(4930),e=h(553),u=h(6636);const d="/tools/screen-recorder",f="Free Online Screen Recorder - Record Your Screen with Audio and Webcam",_="Record your screen with audio and webcam for free with our online screen recorder. No download required, no watermark, no sign-up required.",y=`${e.N.screenshotsBaseUrl}/screen-recorder.png`,x={mainHeading:"Free Online Screen Recorder - Record Your Screen with Audio, Webcam and No Watermark",subHeading:"HD Screen Recording With Mic & Camera",navigationUrl:d,pageTitle:f,metaTags:[{name:"description",content:_},{name:"author",content:"Gaurav Kumar Yadav"},{name:"robots",content:"index, follow"},{property:"og:title",content:f},{property:"og:type",content:"website"},{property:"og:url",content:`${e.N.hostname}${d}`},{property:"og:image",content:y},{property:"og:image:secure_url",content:y},{property:"og:description",content:_},{property:"og:site_name",content:"WebToolsEasy"},{property:"twitter:card",content:"summary_large_image"},{property:"twitter:site",content:"@webtoolseasy"},{property:"twitter:title",content:f},{property:"twitter:description",content:_},{property:"twitter:image",content:y}],tags:"online screen recorder,free screen recorder,screen recorder with audio,screen recorder with webcam,screen recorder for tutorials,screen recorder for demos,screen recorder for video lectures,screen recorder for webinars,screen recorder for gameplay,screen recorder for Windows,screen recorder for Mac,screen recorder for Chromebook,screen recorder for Linux".split(",").map(i=>i.trim()),icons:[{iconName:"screen-icon",iconRelativeUrl:"screen.svg"},{iconName:"video-convert-icon",iconRelativeUrl:"video-convert.svg"}],relatedTools:[{applicationId:"videoconverter",displayText:u.x.VIDEO_CONVERTER,iconName:"video-convert-icon",navigateUrl:"/tools/video-converter"}]},k=[{heading:"Why Use a Screen Recorder?",listData:["To create tutorials and demos. Screen recorders are a great way to create tutorials and demos of how to use software or complete a task.","To record video lectures and webinars. Screen recorders can be used to record video lectures and webinars for students or clients to watch later.","To record gameplay. Screen recorders are also popular for recording gameplay footage to share with friends or online communities."]},{heading:"Features of Our Online Screen Recorder",listData:["Free to use. No need to pay or sign up for an account.","No download required. Record your screen directly from your web browser.","Record screen, audio, and webcam. Capture everything on your screen, as well as your audio and webcam.",'Easy to use. Simply click the "Start Recording" button and start recording.',"Save your recordings to your computer. Once you're finished recording, you can save your recording to your computer."]},{heading:"How to Use Our Online Screen Recorder",listData:['Go to our website and click the "Start Recording" button.',"Select the area of the screen you want to record.","Choose whether you want to record audio and/or webcam.",'Click the "Start Recording" button to begin recording.','Click the "Stop Recording" button when you\'re finished recording.',"Save your recording to your computer."]},{heading:"Tips for Using a Screen Recorder",listData:["Choose the right recording mode. There are different recording modes available, such as full screen, custom region, and window. Choose the recording mode that best suits your needs.","Use a high-quality microphone. If you're recording audio, make sure to use a high-quality microphone to ensure good sound quality.","Edit your recordings. Once you're finished recording, you can edit your recordings to remove any unwanted footage or add annotations.","Share your recordings online. Once you're happy with your recordings, you can share them online with others on social media or video sharing platforms."]},{blockData:["Our free online screen recorder is a great way to record your screen with audio and webcam. It is easy to use, no download required, and no sign-up required. With our screen recorder, you can create tutorials and demos, record video lectures and webinars, record gameplay, and more."]}];function S(i){return new Promise((s,c)=>{i.oncomplete=i.onsuccess=()=>s(i.result),i.onabort=i.onerror=()=>c(i.error)})}let T;function R(){return T||(T=function U(i,s){const c=indexedDB.open(i);c.onupgradeneeded=()=>c.result.createObjectStore(s);const n=S(c);return(a,m)=>n.then(g=>m(g.transaction(s,a).objectStore(s)))}("keyval-store","keyval")),T}function P(i,s=R()){return s("readonly",c=>S(c.get(i)))}function O(i=R()){return i("readwrite",s=>(s.clear(),S(s.transaction)))}var G=h(1273),M=h(1088),F=h(8645),Z=h(9773),j=h(6179),r=h(5879),J=h(3242),I=h(617),A=h(2296),N=h(5986),D=h(5940);function W(i,s){1&i&&r._UZ(0,"mat-icon",11)}function H(i,s){1&i&&(r.TgZ(0,"span",12),r._uU(1,"screen capturing is not supported by host browser"),r.qZA())}function L(i,s){if(1&i){const c=r.EpF();r.TgZ(0,"section",13)(1,"mat-checkbox",14),r.NdJ("change",function(a){r.CHM(c);const m=r.oxw();return r.KtG(m.recorderOptionChange(a,"mic-audio"))}),r._uU(2,"include mic audio"),r.qZA(),r.TgZ(3,"mat-checkbox",14),r.NdJ("change",function(a){r.CHM(c);const m=r.oxw();return r.KtG(m.recorderOptionChange(a,"camera-video"))}),r._uU(4,"include camera video"),r.qZA()()}}function B(i,s){if(1&i){const c=r.EpF();r.TgZ(0,"button",15),r.NdJ("click",function(){r.CHM(c);const a=r.oxw();return r.KtG(a.startRecording())}),r.TgZ(1,"mat-icon"),r._uU(2,"play_arrow"),r.qZA(),r._uU(3," Start Recording "),r.qZA()}}function Y(i,s){if(1&i){const c=r.EpF();r.TgZ(0,"button",16),r.NdJ("click",function(){r.CHM(c);const a=r.oxw();return r.KtG(a.pauseRecording())}),r.TgZ(1,"mat-icon"),r._uU(2,"pause"),r.qZA(),r._uU(3," Pause Recording "),r.qZA()}}function K(i,s){if(1&i){const c=r.EpF();r.TgZ(0,"button",17),r.NdJ("click",function(){r.CHM(c);const a=r.oxw();return r.KtG(a.resumeRecording())}),r.TgZ(1,"mat-icon"),r._uU(2,"play_arrow"),r.qZA(),r._uU(3," Resume Recording "),r.qZA()}}function Q(i,s){if(1&i){const c=r.EpF();r.TgZ(0,"button",18),r.NdJ("click",function(){r.CHM(c);const a=r.oxw();return r.KtG(a.stopRecording())}),r.TgZ(1,"mat-icon"),r._uU(2,"stop"),r.qZA(),r._uU(3," Stop Recording "),r.qZA()}}function z(i,s){1&i&&(r.TgZ(0,"div",19),r._UZ(1,"mat-spinner",20),r.TgZ(2,"span",21),r._uU(3,"preparing video file to download"),r.qZA()())}const q=[{path:"",component:(()=>{var i;class s{constructor(n,a,m,g){this.renderer=n,this.zoneRef=a,this.breakpointObserver=m,this.platformMetaDataService=g,this.isRecording=!1,this.isProcessingStream=!1,this.isRecPaused=!1,this.timeCounter=0,this.videoChunksIds=[],this.videoFileExtention="webm",this.recorderOptionConfig={webm:{mimeType:"video/webm; codecs=vp9"},mp4:{mimeType:"video/mp4"}},this.cameraVideoOptions={width:150,height:150},this.includeScreenAudio=!1,this.includeMicAudio=!1,this.includeCameraVideo=!1,this.videoChunksCounter=0,this.isSupported=!0,this.destroyed=new F.x,this.applicationConfig=x,this.descriptionData=k,this.breakpointObserver.observe([M.u3.Handset,M.u3.Web]).pipe((0,Z.R)(this.destroyed)).subscribe(w=>{this.isMobile=m.isMatched(`(max-width: ${j.U})`),this.checkCompatibility()}),this.checkCompatibility()}checkCompatibility(){e.N.production&&(this.isSupported=!this.isMobile)}ngOnDestroy(){this.platformMetaDataService.isPlatformBrowser&&O(),this.destroyed.next(),this.destroyed.complete()}resetContextVariables(){this.screenStream=void 0,this.webcamStream=void 0,this.mergedMediaStream=void 0,this.mediaStreamRecorder=void 0,this.videoChunksCounter=0,this.videoChunksIds=[]}startRecording(){var n=this;this.zoneRef.run((0,o.Z)(function*(){n.isRecording=!0,n.resetContextVariables(),yield O();try{n.screenStream=yield n.getScreenStream(),t.j.info(`screen stream dimensions: ${n.getVideoStreamHeightWidth(n.screenStream)}`),n.configureStreamStopListener(n.screenStream)}catch(a){t.j.error("error occured while capturing screen stream"),t.j.error(a),n.stopRecording()}try{(n.includeMicAudio||n.includeCameraVideo)&&(n.webcamStream=yield n.getCameraAndMicStream(),n.configureStreamStopListener(n.webcamStream))}catch(a){t.j.error("error occured while capturing camera or mic media stream"),t.j.error(a),n.stopRecording()}n.webcamStream?(n.mergedMediaStream=n.mergeMediaStreams(n.screenStream,n.webcamStream),n.mergedMediaStream||(t.j.error("error encountered while merging media streams"),n.stopRecording())):n.mergedMediaStream=n.screenStream,n.mergedMediaStream&&n.configureStreamRecorder(n.mergedMediaStream)}))}configureStreamStopListener(n){n.getTracks().forEach(a=>{a.addEventListener("ended",m=>{t.j.info("media stream track has ended"),this.isRecording&&this.stopRecording()})})}mergeMediaStreams(n,a){const m=this.screenStream?.getVideoTracks()[0].getSettings();let w=new G.VideoStreamMerger({width:m.width,height:m.height});return w.addStream(n,{x:0,y:0,width:w.width,height:w.height,mute:!0,index:0}),w.addStream(a,{x:w.width-this.cameraVideoOptions.width,y:w.height-this.cameraVideoOptions.height,width:this.cameraVideoOptions.width,height:this.cameraVideoOptions.height,mute:!1,index:1}),w.start(),w.result}configureStreamRecorder(n){t.j.info("configuring media stream recorder"),this.mediaStreamRecorder=new MediaRecorder(n,this.recorderOptionConfig[this.videoFileExtention]),this.mediaStreamRecorder.ondataavailable=a=>{const m=Date.now();(function V(i,s,c=R()){c("readwrite",n=>(n.put(s,i),S(n.transaction)))})(m,a.data),this.videoChunksIds.push(m)},this.mediaStreamRecorder.start(s.RECORDER_TIME_SLICE_MS)}getScreenStream(){var n=this;return(0,o.Z)(function*(){const a={video:!0,audio:!1};return n.includeScreenAudio&&(a.audio=!0),navigator.mediaDevices.getDisplayMedia(a)})()}getCameraAndMicStream(){var n=this;return(0,o.Z)(function*(){return navigator.mediaDevices.getUserMedia({video:n.includeCameraVideo,audio:n.includeMicAudio})})()}pauseRecording(){this.mediaStreamRecorder?.pause(),this.isRecPaused=!0}resumeRecording(){this.mediaStreamRecorder?.resume(),this.isRecPaused=!1}stopRecording(){this.mediaStreamRecorder?.stop(),this.screenStream?.getTracks().forEach(n=>n.stop()),this.webcamStream?.getTracks().forEach(n=>n.stop()),this.mergedMediaStream?.getTracks().forEach(n=>n.stop()),this.screenStream&&this.mergedMediaStream&&this.processMediaStream(),this.isRecording=!1}processMediaStream(){var n=this;this.isProcessingStream=!0,setTimeout((0,o.Z)(function*(){try{const a=[];n.videoChunksIds.sort(function(g,w){return g-w});const m=n.videoChunksIds.length;for(let g=0;g<m;g++)a.push(yield P(n.videoChunksIds[g]));yield n.downloadVideoFile("recorded-video-file.webm",new Blob(a,{type:"video/webm"})),n.zoneRef.run(()=>n.isProcessingStream=!1),O()}catch(a){t.j.info("error occured while preparing video file for download"),t.j.error(a),n.zoneRef.run(()=>n.isProcessingStream=!1)}}),s.RECORDING_START_DELAY_MS)}recorderOptionChange(n,a){switch(t.j.info(`recorder option changed: ${a}`),a){case"mic-audio":this.includeMicAudio=n.checked;break;case"camera-video":this.includeCameraVideo=n.checked}}downloadVideoFile(n,a){var m=this;return(0,o.Z)(function*(){const g=m.renderer.createElement("a");m.renderer.setProperty(g,"href",URL.createObjectURL(a)),m.renderer.setProperty(g,"download",n),g.click()})()}getVideoStreamHeightWidth(n){if(n.getVideoTracks().length>0){const a=n.getVideoTracks()[0].getSettings();return`[ height: ${a.height}, width: ${a.width} ]`}return""}}return(i=s).RECORDING_START_DELAY_MS=5e3,i.RECORDER_TIME_SLICE_MS=100,i.\u0275fac=function(n){return new(n||i)(r.Y36(r.Qsj),r.Y36(r.R0b),r.Y36(M.Yg),r.Y36(J.H))},i.\u0275cmp=r.Xpm({type:i,selectors:[["app-screen-recorder"]],decls:11,vars:8,consts:[[1,"flex-display","flex-column-flow","flex-align-center","full-width","flex-gap-large"],[1,"flex-display","flex-column-flow","flex-center","flex-align-center","full-width","icon-div"],["svgIcon","screen-icon",4,"ngIf"],["class","error",4,"ngIf"],["class","flex-display recoder-options",4,"ngIf"],[1,"flex-display","flex-row-flow","flex-gap-medium"],["mat-stroked-button","","aria-label","start recording button","color","primary",3,"click",4,"ngIf"],["mat-stroked-button","","aria-label","pause recording button","color","warn",3,"click",4,"ngIf"],["mat-stroked-button","","aria-label","resume recording button","color","accent",3,"click",4,"ngIf"],["mat-raised-button","","aria-label","stop recording button","color","warn",3,"click",4,"ngIf"],["class","flex-display flex-row-flow flex-align-center",4,"ngIf"],["svgIcon","screen-icon"],[1,"error"],[1,"flex-display","recoder-options"],[3,"change"],["mat-stroked-button","","aria-label","start recording button","color","primary",3,"click"],["mat-stroked-button","","aria-label","pause recording button","color","warn",3,"click"],["mat-stroked-button","","aria-label","resume recording button","color","accent",3,"click"],["mat-raised-button","","aria-label","stop recording button","color","warn",3,"click"],[1,"flex-display","flex-row-flow","flex-align-center"],["color","primary","diameter","30",2,"margin-right","10px"],[1,"bold-text"]],template:function(n,a){1&n&&(r.TgZ(0,"div",0)(1,"div",1),r.YNc(2,W,1,0,"mat-icon",2),r.qZA(),r.YNc(3,H,2,0,"span",3),r.YNc(4,L,5,0,"section",4),r.TgZ(5,"div",5),r.YNc(6,B,4,0,"button",6),r.YNc(7,Y,4,0,"button",7),r.YNc(8,K,4,0,"button",8),r.YNc(9,Q,4,0,"button",9),r.qZA(),r.YNc(10,z,4,0,"div",10),r.qZA()),2&n&&(r.xp6(2),r.Q6J("ngIf",a.platformMetaDataService.isPlatformBrowser),r.xp6(1),r.Q6J("ngIf",!a.isSupported),r.xp6(1),r.Q6J("ngIf",a.isSupported),r.xp6(2),r.Q6J("ngIf",!a.isRecording&&!a.isProcessingStream&&a.isSupported),r.xp6(1),r.Q6J("ngIf",a.isRecording&&!a.isRecPaused),r.xp6(1),r.Q6J("ngIf",a.isRecording&&a.isRecPaused),r.xp6(1),r.Q6J("ngIf",a.isRecording&&!a.isProcessingStream&&a.isSupported),r.xp6(1),r.Q6J("ngIf",a.isProcessingStream))},dependencies:[l.O5,I.Hw,A.lW,N.oG,D.Ou],styles:[".icon-div[_ngcontent-%COMP%]{height:300px}.icon-div[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{transform:scale(10)}.error[_ngcontent-%COMP%]{color:red;font-size:large;font-style:italic;font-weight:700}@media screen and (max-width: 735px){.icon-div[_ngcontent-%COMP%]{height:150px}.icon-div[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{transform:scale(5)}.recoder-options[_ngcontent-%COMP%]{flex-direction:column}.error[_ngcontent-%COMP%]{font-size:small}}"]}),s})()}];let $=(()=>{var i;class s{}return(i=s).\u0275fac=function(n){return new(n||i)},i.\u0275mod=r.oAB({type:i}),i.\u0275inj=r.cJS({imports:[p.Bz.forChild(q),p.Bz]}),s})(),X=(()=>{var i;class s{}return(i=s).\u0275fac=function(n){return new(n||i)},i.\u0275mod=r.oAB({type:i}),i.\u0275inj=r.cJS({imports:[l.ez,$,I.Ps,A.ot,N.p9,D.Cq]}),s})()},4930:(C,v,h)=>{"use strict";h.d(v,{j:()=>p});var l=h(553);class p{static info(t,...e){l.N.production||(e.length>0?console.info(t,e):console.info(t))}static debug(t,...e){l.N.production||(e.length>0?console.debug(t,e):console.debug(t))}static error(t,...e){e.length>0?console.error(t,e):console.error(t)}}},6636:(C,v,h)=>{"use strict";h.d(v,{o:()=>p,x:()=>l});var l=function(o){return o.VIDEO_CONVERTER="Video to Audio Converter",o.SCREEN_RECORDER="Free Screen Recorder",o.TEXT_COMPARE="Online Text Compare",o.JWT_DECODER="JWT Decoder",o.IMAGE_COMPRESSOR="Free Image Compressor",o.JS_FORMATTER="Online Javascript Formatter",o.JSON_FORMATTER="Online JSON Formatter",o.HTML_FORMATTER="Online HTML Formatter",o.CSS_FORMATTER="Online CSS Formatter",o.JSON_VIEWER="Online JSON Viewer",o.PASSWORD_GENERATOR="Random Password Generator",o.BASE64_ENCODE="Base64 Encoder",o.BASE64_DECODE="Base64 Decoder",o.CRON_GENERATOR="Cron Expression Generator",o.IMAGE_CROPPER="Free Image Cropper",o.UUID_VERSION1_GENERATOR="UUID V1 Generator",o.UUID_VERSION4_GENERATOR="UUID V4 Generator",o.GUID_GENERATOR="GUID Generator",o.MARKDOWN_EDITOR="Markdown Editor",o.WORD_COUNTER="Word Counter",o.QR_CODE_GENERATOR="QR Code Generator",o}(l||{});const p=[{applicationId:"qrcodegenerator",displayText:l.QR_CODE_GENERATOR,iconName:"qr-code",navigateUrl:"/tools/qr-code-generator"},{applicationId:"wordcounter",displayText:l.WORD_COUNTER,iconName:"word-icon",navigateUrl:"/tools/word-counter"},{applicationId:"textcompare",displayText:l.TEXT_COMPARE,iconName:"comparison-icon",navigateUrl:"/tools/text-compare"},{applicationId:"markdowneditor",displayText:l.MARKDOWN_EDITOR,iconName:"markdown-icon",navigateUrl:"/tools/markdown-editor"},{applicationId:"passwordgenerator",displayText:l.PASSWORD_GENERATOR,iconName:"password-icon",navigateUrl:"/tools/password-generator"},{applicationId:"videoconverter",displayText:l.VIDEO_CONVERTER,iconName:"video-convert-icon",navigateUrl:"/tools/video-converter"},{applicationId:"screen-recorder",displayText:l.SCREEN_RECORDER,iconName:"screen-icon",navigateUrl:"/tools/screen-recorder"},{applicationId:"imagecompress",displayText:l.IMAGE_COMPRESSOR,iconName:"image-icon",navigateUrl:"/tools/image-compress"},{applicationId:"imagecropper",displayText:l.IMAGE_CROPPER,iconName:"image-icon",navigateUrl:"/tools/crop-image"},{applicationId:"jwt",displayText:l.JWT_DECODER,iconName:"jwt-icon",navigateUrl:"/tools/jwt"},{applicationId:"jsformatter",displayText:l.JS_FORMATTER,iconName:"js-icon",navigateUrl:"/tools/js-formatter"},{applicationId:"jsonformatter",displayText:l.JSON_FORMATTER,iconName:"json-icon",navigateUrl:"/tools/json-formatter"},{applicationId:"jsonviewer",displayText:l.JSON_VIEWER,iconName:"json-icon",navigateUrl:"/tools/json-viewer"},{applicationId:"htmlformatter",displayText:l.HTML_FORMATTER,iconName:"html-icon",navigateUrl:"/tools/html-formatter"},{applicationId:"cssformatter",displayText:l.CSS_FORMATTER,iconName:"css-icon",navigateUrl:"/tools/css-formatter"},{applicationId:"base64encoder",displayText:l.BASE64_ENCODE,iconName:"file-encode-icon",navigateUrl:"/tools/base64-encode"},{applicationId:"base64decoder",displayText:l.BASE64_DECODE,iconName:"file-decode-icon",navigateUrl:"/tools/base64-decode"},{applicationId:"crongenerator",displayText:l.CRON_GENERATOR,iconName:"cron-icon",navigateUrl:"/tools/cron-expression"},{applicationId:"uuidv4",displayText:l.UUID_VERSION4_GENERATOR,iconName:"uuid-icon",navigateUrl:"/tools/uuid-v4-generator"},{applicationId:"uuidv1",displayText:l.UUID_VERSION1_GENERATOR,iconName:"uuid-icon",navigateUrl:"/tools/uuid-v1-generator"},{applicationId:"guid",displayText:l.GUID_GENERATOR,iconName:"uuid-icon",navigateUrl:"/tools/guid-generator"}]},1273:function(C){C.exports=function(){"use strict";var v={d:function(p,o){for(var t in o)v.o(o,t)&&!v.o(p,t)&&Object.defineProperty(p,t,{enumerable:!0,get:o[t]})},o:function(p,o){return Object.prototype.hasOwnProperty.call(p,o)},r:function(p){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(p,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(p,"__esModule",{value:!0})}},h={};v.r(h),v.d(h,{VideoStreamMerger:function(){return l}});class l{constructor(o){this.width=720,this.height=405,this.fps=25,this._streams=[],this._frameCount=0,this.clearRect=!0,this.started=!1,this.result=null,this.supported=null,this._canvas=null,this._ctx=null,this._videoSyncDelayNode=null,this._audioDestination=null,this._audioCtx=null;const t=window.AudioContext||window.webkitAudioContext,e=!(!window.AudioContext||!(new t).createMediaStreamDestination),u=!!document.createElement("canvas").captureStream;if(!(this.supported=e&&u))return;this.setOptions(o);const d=this._audioCtx=new t,f=this._audioDestination=d?.createMediaStreamDestination();this._videoSyncDelayNode=d.createDelay(5),this._videoSyncDelayNode.connect(f),this._setupConstantNode(),this.started=!1,this.result=null,this._backgroundAudioHack()}setOptions(o){this._audioCtx=(o=o||{}).audioContext||new AudioContext,this.width=o.width||this.width,this.height=o.height||this.width,this.fps=o.fps||this.fps,this.clearRect=void 0===o.clearRect||o.clearRect}setOutputSize(o,t){this.width=o,this.height=t,this._canvas&&(this._canvas.setAttribute("width",this.width.toString()),this._canvas.setAttribute("height",this.height.toString()))}getAudioContext(){return this._audioCtx}getAudioDestination(){return this._audioDestination}getCanvasContext(){return this._ctx}_backgroundAudioHack(){if(this._audioCtx){const o=this._createConstantSource(),t=this._audioCtx.createGain();t&&o&&(t.gain.value=.001,o.connect(t),t.connect(this._audioCtx.destination),o.start())}}_setupConstantNode(){if(this._audioCtx&&this._videoSyncDelayNode){const o=this._createConstantSource();if(o){o.start();const t=this._audioCtx.createGain();t.gain.value=0,o.connect(t),t.connect(this._videoSyncDelayNode)}}}_createConstantSource(){if(this._audioCtx){if(this._audioCtx.createConstantSource)return this._audioCtx.createConstantSource();const o=this._audioCtx.createBufferSource(),t=this._audioCtx.createBuffer(1,1,this._audioCtx.sampleRate);return t.getChannelData(0)[0]=10,o.buffer=t,o.loop=!0,o}}updateIndex(o,t){"string"==typeof o&&(o={id:o}),t=t??0;for(let e=0;e<this._streams.length;e++)o.id===this._streams[e].id&&(this._streams[e].index=t);this._sortStreams()}_sortStreams(){this._streams=this._streams.sort((o,t)=>o.index-t.index)}addMediaElement(o,t,e){if((e=e||{}).x=e.x||0,e.y=e.y||0,e.width=e.width||this.width,e.height=e.height||this.height,e.mute=e.mute||e.muted||!1,e.oldDraw=e.draw,e.oldAudioEffect=e.audioEffect,e.draw=t instanceof HTMLVideoElement||t instanceof HTMLImageElement?(u,d,f)=>{e.oldDraw?e.oldDraw(u,t,f):(u.drawImage(t,e.x,e.y,null==e.width?this.width:e.width,null==e.height?this.height:e.height),f())}:null,this._audioCtx&&!e.mute){const u=t._mediaElementSource||this._audioCtx.createMediaElementSource(t);t._mediaElementSource=u,u.connect(this._audioCtx.destination);const d=this._audioCtx.createGain();u.connect(d),(t instanceof HTMLVideoElement||t instanceof HTMLAudioElement)&&t.muted?(t.muted=!1,t.volume=.001,d.gain.value=1e3):d.gain.value=1,e.audioEffect=(f,_)=>{e.oldAudioEffect?e.oldAudioEffect(d,_):d.connect(_)},e.oldAudioEffect=null}this.addStream(o,e)}addStream(o,t){if("string"==typeof o)return this._addData(o,t);const e={isData:!1};e.x=(t=t||{}).x||0,e.y=t.y||0,e.width=t.width,e.height=t.height,e.draw=t.draw||null,e.mute=t.mute||t.muted||!1,e.audioEffect=t.audioEffect||null,e.index=null==t.index?0:t.index,e.hasVideo=o.getVideoTracks().length>0,e.hasAudio=o.getAudioTracks().length>0;let u=null;for(let d=0;d<this._streams.length;d++)this._streams[d].id===o.id&&(u=this._streams[d].element);u||(u=document.createElement("video"),u.autoplay=!0,u.muted=!0,u.playsInline=!0,u.srcObject=o,u.setAttribute("style","position:fixed; left: 0px; top:0px; pointer-events: none; opacity:0;"),document.body.appendChild(u),u.play().catch(null),e.hasAudio&&this._audioCtx&&!e.mute&&(e.audioSource=this._audioCtx.createMediaStreamSource(o),e.audioOutput=this._audioCtx.createGain(),e.audioOutput.gain.value=1,e.audioEffect?e.audioEffect(e.audioSource,e.audioOutput):e.audioSource.connect(e.audioOutput),e.audioOutput.connect(this._videoSyncDelayNode))),e.element=u,e.id=o.id||null,this._streams.push(e),this._sortStreams()}removeStream(o){"string"==typeof o&&(o={id:o});for(let t=0;t<this._streams.length;t++){const e=this._streams[t];o.id===e.id&&(e.audioSource&&(e.audioSource=null),e.audioOutput&&(e.audioOutput.disconnect(this._videoSyncDelayNode),e.audioOutput=null),e.element&&e.element.remove(),this._streams[t]=null,this._streams.splice(t,1),t--)}}_addData(o,t){const e={isData:!0};e.draw=(t=t||{}).draw||null,e.audioEffect=t.audioEffect||null,e.id=o,e.element=null,e.index=null==t.index?0:t.index,this._videoSyncDelayNode&&this._audioCtx&&e.audioEffect&&(e.audioOutput=this._audioCtx.createGain(),e.audioOutput.gain.value=1,e.audioEffect(null,e.audioOutput),e.audioOutput.connect(this._videoSyncDelayNode)),this._streams.push(e),this._sortStreams()}_requestAnimationFrame(o){let t=!1;const e=setInterval(()=>{!t&&document.hidden&&(t=!0,clearInterval(e),o())},1e3/this.fps);requestAnimationFrame(()=>{t||(t=!0,clearInterval(e),o())})}start(){var o,t,e,u,d;this._canvas=document.createElement("canvas"),this._canvas.setAttribute("width",this.width.toString()),this._canvas.setAttribute("height",this.height.toString()),this._canvas.setAttribute("style","position:fixed; left: 110%; pointer-events: none"),this._ctx=this._canvas.getContext("2d"),this.started=!0,this._requestAnimationFrame(this._draw.bind(this)),this.result=(null===(o=this._canvas)||void 0===o?void 0:o.captureStream(this.fps))||null;const f=null===(t=this.result)||void 0===t?void 0:t.getAudioTracks()[0];f&&(null===(e=this.result)||void 0===e||e.removeTrack(f));const _=null===(u=this._audioDestination)||void 0===u?void 0:u.stream.getAudioTracks();_&&_.length&&(null===(d=this.result)||void 0===d||d.addTrack(_[0]))}_updateAudioDelay(o){this._videoSyncDelayNode&&this._audioCtx&&this._videoSyncDelayNode.delayTime.setValueAtTime(o/1e3,this._audioCtx.currentTime)}_draw(){var o;if(!this.started)return;this._frameCount++;let t=0;this._frameCount%60==0&&(t=performance.now());let e=this._streams.length;const u=()=>{if(e--,e<=0){if(this._frameCount%60==0){const d=performance.now();this._updateAudioDelay(d-t)}this._requestAnimationFrame(this._draw.bind(this))}};this.clearRect&&(null===(o=this._ctx)||void 0===o||o.clearRect(0,0,this.width,this.height)),this._streams.forEach(d=>{d.draw?d.draw(this._ctx,d.element,u):(!d.isData&&d.hasVideo&&this._drawVideo(d.element,d),u())}),0===this._streams.length&&u()}_drawVideo(o,t){var e;const f=t.height||this.height,_=t.width||this.width;let y=t.x||0,E=t.y||0;try{null===(e=this._ctx)||void 0===e||e.drawImage(o,y,E,_,f)}catch(x){console.error(x)}}stop(){var o,t;this.started=!1,this._canvas=null,this._ctx=null,this._streams.forEach(e=>{e.element&&e.element.remove()}),this._streams=[],null===(o=this._audioCtx)||void 0===o||o.close(),this._audioCtx=null,this._audioDestination=null,this._videoSyncDelayNode=null,null===(t=this.result)||void 0===t||t.getTracks().forEach(e=>{e.stop()}),this.result=null}destroy(){this.stop()}}return typeof window<"u"&&(window.VideoStreamMerger=l),h}()}}]);